这份 PRD 专为 AI 编程工具（如 Claude 3.5 Sonnet, Cursor, 或 GPT-4）设计。它包含了清晰的业务逻辑、技术路径和 UI 交互规范，能够让 AI 直接理解并开始编写代码。

# ---

**产品需求文档 (PRD)：图书管理督导工作自动化汇总系统**

## **1\. 项目背景与目标**

**背景：** 图书馆督导每周需手动合并来自三个楼层的 Word 统计表。目前流程涉及大量重复的复制、查找、姓名排序、手动合并单元格及加和计算。 **目标：** 开发一个 Web 工具，实现“上传三份文档 \-\> 自动处理数据 \-\> 预览修改 \-\> 下载汇总文档”的全自动化流程。

## ---

**2\. 核心业务逻辑 (AI 逻辑重点)**

### **2.1 数据提取 (Input)**

* **多源输入：** 支持上传 1-3 个 .docx 文件。

* **表格解析：** 识别文档中的唯一表格，提取从第 2 行（跳过表头）开始的每一行数据。

* **关键字段：** 助理（姓名）、日期、上书量（本）、纠错量（本）、整架范围、工作地点、督导检查情况。

### **2.2 数据整合逻辑 (Processing)**

1. **扁平化：** 将三个文件的所有行提取到一个列表中。  
2. **排序规则：** \* 首要排序：**助理姓名**（相同名字的助理必须排在一起）。

   * 次要排序：**日期**（同一助理按时间先后排列）。

3. **汇总计算：**  
   * **总人数：** 统计助理姓名的去重总数。

   * **总班次：** 统计所有有效记录的总行数。

   * **数据求和：** 对“上书量”和“纠错量”列进行全量求和。

4. **文本聚合：** \* 将三个楼层“督导检查情况”单元格内的“存在问题：”后的内容提取出来。

   * 统一合并到汇总文档的第一个“督导检查情况”单元格中。

### **2.3 Word 导出逻辑 (Output)**

* **垂直合并 (Cell Merge)：** 如果同一位助理有多条记录，第一列（序号）和第二列（助理姓名）必须进行**垂直合并**，保持界面整洁。

* **模板复刻：** 导出文档的表头、字体、字号、对齐方式需与原始模板完全一致。

## ---

**3\. 功能模块设计**

### **3.1 前端界面 (React \+ Tailwind CSS)**

* **上传区：** 拖拽上传 3 个 Word 文档。  
* **预览编辑区：** \* 以 HTML Table 形式展示合并后的预览数据。  
  * 允许用户直接在网页上修改“上书量”或“整架范围”等文字。  
* **操作区：** “开始处理”按钮、“下载汇总文档”按钮。

### **3.2 后端服务 (Python FastAPI \+ python-docx)**

* **文件解析：** 使用 python-docx 读取表格内容，处理空行。  
* **文档生成：** \* 利用 table.rows\[i\].cells\[j\].merge(table.rows\[k\].cells\[j\]) 实现垂直合并。  
  * 动态计算行数并填充底部的“总计”和“备注”行。

## ---

**4\. 技术栈推荐**

* **Frontend:** React (Vite), Lucide-react (图标), Tailwind CSS.  
* **Backend:** Python 3.10+, FastAPI.  
* **Doc Processing:** python-docx, pandas (用于高效排序和聚合)。  
* **Deployment:** 可本地运行或部署至 Vercel/Render。

## ---

**5\. 数据库设计 (极简)**

无需持久化存储。使用 **Session 存储** 或 **临时缓存** 处理当前上传的文件，下载后即刻销毁。

## ---

**6\. API 接口定义**

| 路径 | 方法 | 功能 | 输入 | 输出 |
| :---- | :---- | :---- | :---- | :---- |
| /upload | POST | 上传并解析 Word | 1-3 个 .docx 文件 | 整理后的 JSON 数据 (包含 List, Totals) |
| /export | POST | 接收修改后的数据并下载 | 修正后的 JSON | 二进制 .docx 文件流 |

## ---

**7\. 给 AI 的指令预览 (Prompt Context)**

"请根据以上 PRD，首先编写后端 FastAPI 逻辑，重点处理 python-docx 的表格合并算法。确保在处理助理姓名列时，检测连续相同的姓名并执行单元格合并。接着编写前端 React 页面，提供一个优雅的上传界面，并在数据返回后允许用户在线微调表格内容。"

### ---

**用户确认：**

这个 PRD 文档已经完全覆盖了你提到的“查找、合并、自动计算”的核心需求。**你需要我现在把这段文档转化为一个可以直接发给 Claude 或 GPT 的“开发提示词 (Developer Prompt)”吗？**